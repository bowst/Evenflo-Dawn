<script type="text/javascript">

    window.kameleoonQueue = window.kameleoonQueue || [];

    const kameleoonValidatePrice = (price) => {
      let validatePrice = String(price).replace(/[,. ]/g, "");
      let penny = validatePrice.substring(validatePrice.length - 2, validatePrice.length);
      return validatePrice.substring(0, validatePrice.length - 2) + "." + penny;
    };

    var cart_items = {{cart.items | json}};

    var temp = [
      {% for item in cart.items %}
      {
        "price": kameleoonValidatePrice("{{ item.price | money_without_currency }}"),
        "original_price": kameleoonValidatePrice("{{ item.original_price | money_without_currency }}"),
        "discounted_price": kameleoonValidatePrice("{{ item.discounted_price | money_without_currency }}"),
        "line_price": kameleoonValidatePrice("{{ item.line_price | money_without_currency }}"),
        "original_line_price": kameleoonValidatePrice("{{ item.original_line_price | money_without_currency }}"),
        "total_discount": kameleoonValidatePrice("{{ item.total_discount | money_without_currency }}"),
        "final_price": kameleoonValidatePrice("{{ item.final_price | money_without_currency }}"),
        "final_line_price": kameleoonValidatePrice("{{ item.final_line_price | money_without_currency }}"),
      },
      {% endfor %}
    ];
    
    cart_items = cart_items.map((item, i) => ({
      ...item,
      ...temp[i]
    }))

    if (cart_items.length > 0){

    cart_items.forEach(function (product_item) {

    kameleoonQueue.push(['Products.trackAddToCart', product_item.product_id.toString(), parseFloat(product_item.final_price), product_item.quantity]);

    });

    }
</script>