{{ 'component-accordion.css' | asset_url | stylesheet_tag }}
{{ 'collapsible-content.css' | asset_url | stylesheet_tag }}
{{ 'section-product-faq.css' | asset_url | stylesheet_tag }}
{% assign faqs = product.metafields.custom.pdp_faq.value %}

{% if faqs.first %}
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {% for faq in faqs %}
          {
            "@type": "Question",
            "name": "{{ faq.question }}",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": {{ faq.answer | strip_html | json }}
            }
          }{% unless forloop.last %}, {% endunless %}
        {%- endfor -%}
      ]
    }
  </script>
{% endif %}

{% if faqs %}
  <section class="product-faq">
    <div class="content-container page-width content-container--full-width flex-container">
      <div class="column column-1">
        <h2 class="h1 heading-underline">All your Questions Answered</h2>
        {% if product.metafields.custom.product_support_link %}
          <a href="{{ product.metafields.custom.product_support_link.value.url }}">View the Product Support Guide</a>
        {% endif %}
      </div>
      <div class="column column-2">
        <div class="collapsible-content isolate" id="questions">
          <div class="collapsible-content__wrapper">
            {% for faq in faqs %}
              <div class="accordion">
                <details>
                  <summary>
                    <h3 class="accordion__title">Q. {{ faq.question }}</h3>
                    {% render 'icon-caret' %}
                  </summary>

                  <div class="accordion__content rtl">
                    {{ faq.answer }}
                  </div>
                </details>
              </div>
            {%- endfor -%}
          </div>
        </div>
      </div>
    </div>
  </section>
{% endif %}

{% schema %}
{
  "name": "PDP FAQ",
  "class": "text",
  "tag": "section",
  "settings": [],
  "presets": [
    {
      "name": "Evenflo PDP FAQ"
    }
  ]
}
{% endschema %}
